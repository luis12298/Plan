<!DOCTYPE html>
<html>

<head>
   <title>Cargar archivo Excel en tabla HTML</title>
   <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   <script src="https://cdn.datatables.net/1.10.25/js/jquery.dataTables.min.js"></script>
   <link rel="stylesheet" href="https://cdn.datatables.net/1.10.25/css/jquery.dataTables.min.css">
   <link rel="stylesheet" href="style.css">
   <link rel="shortcut icon" href="img/icono.png" type="image/x-icon">
   <style>
      .table-responsive {
         padding-top: 1rem;
         overflow-x: auto;
         -webkit-overflow-scrolling: touch;
      }
   </style>
</head>

<body>
   <div class="container">
      <h1>Busqueda de datos en Excel</h1>

      <input type="file" id="fileInput" accept=".xlsx">
      <label for="Hoja">Elija una Hoja<select name="" id="sheet-select">
            <option value="">Elegir</option>
         </select></label>
   </div>
   <div class="table-responsive">
      <table id="dataTable" class="display">
         <thead>
            <tr></tr>
         </thead>
         <tbody></tbody>
      </table>
   </div>

   <script src="xlsx.full.min.js"></script>
   <script src="script.js"></script>

   <script>
      var archivoCargado = false;
      $('#fileInput').on('change', function () {
         if (archivoCargado) {
            var confirmacion = confirm("¿Está seguro de que desea cargar otro archivo? El archivo actual se reemplazará.");
            if (confirmacion == false) {
               // El usuario ha cancelado, restablecer el valor del campo de entrada de archivo
               $('#fileInput').val('');
               return; // detener la ejecución del código
            }
         }
         archivoCargado = true;
         // Continuar con la carga del archivo
      });
      window.addEventListener("beforeunload", function (e) {
         var confirmationMessage = "¿Está seguro de que desea abandonar esta página?";
         e.returnValue = confirmationMessage;
         return confirmationMessage;
      });
   </script>
</body>

</html>